@using HrModell;
@{
    Layout = null;
}
@{

    var list = ViewData["zhi"] as List<QueryList>;
    var xcid = ViewData["xcid"];
    var bid = ViewData["bid"];
    var jg = ViewData["jg"];
    var countr = ViewData["countr"];
    var sum = ViewData["sum"];
    var index = 0;
    var bosum = "bounsSum";
    var saleSum = "saleSum";
    var deductSum = "deductSum";
    var salaryPaidSum = "salaryPaidSum";
    var salaryStandardSum = "salaryStandardSum";
    var yi = "yi"; var er = "er"; var san = "san"; var si = "si"; var wu = "wu";
    var kg = "kg";
    var salaryPaidSum2 = "salaryPaidSum2";
    var did = "did"; var name = "name";var jl = "jl";var jx = "jx";var yk = "yk";var bz = "bz";var sf = "sf";
    var jlid = "jlid";  var jxid = "jxid";  var ykid = "ykid";  var sfid = "sfid";
}
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>QueryList</title>
    <link href="~/css/table.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-3.3.1.js"></script>
    <link href="~/javaScript/bootstrap.css" rel="stylesheet" />
    <script src="~/javaScript/bootstrap.min.js"></script>
    <script type="text/javascript">

        $(function () {
            var cs = $("#cs").text();
            $("#kg").attr("rowspan", "" + cs + "");
        });
    </script>
    <style>
      body {
        
         background-color:#FFFFCC;
        }

    </style>
</head>
<body>
    <form method="post" action="/SalaryGrant/QueryList">
        <table width="100%">

            <tr>
                <td colspan="2" style="text-align: left">
                    <font color="black">
                        您正在做的业务是：人力资源--薪酬标准管理--薪酬发放登记
                    </font>
                </td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: right;">
                    <input type="submit" value="提交" class="BUTTON_STYLE1">
                    <input type="button" value="返回" onclick="javascript:window.history.back();" class="BUTTON_STYLE1">
                </td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: left">
                    薪酬单编号：<span>@xcid</span><input type="hidden" value="@xcid" name="xcid" />
                    <input type="hidden" name="salaryGrant.salaryGrantId" value="HS1353753198460">
                </td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: left">
                    机构：
                    <span>@jg</span>
                    <input type="hidden" value="@jg" name="jg" />
                </td>
            </tr>
            <tr>
                <td style="text-align: left">
                    本机构总人数:<span>@countr</span><input type="hidden" value="@countr" name="countr" />
                    <input type="hidden" name="salaryGrant.humanAmount" value="5">
                    ，基本薪酬总数:<span>@sum</span><input type="hidden" name="sum" value="@sum" />
                    ，实发总额:<span id="salarySum_sum">@sum</span>
                    <input type="hidden" id="sfs" name="sfsum" value="@sum" />

                </td>
                <td style="text-align: right;">
                    登记人:<input type="text" name="djr" value="阳旭明" size="8" readonly="readonly">
                    登记时间：<span id="Tdate"></span>
                    <input type="hidden" name="djtime" id="Tdate2">
                </td>
            </tr>
        </table>


        <table width="100%" border="1" cellpadding=0 cellspacing=1
               bordercolorlight=#848284 bordercolordark=#eeeeee
               class="TABLE_STYLE1">
            <tr>
                <td class="TD_STYLE1">
                    <span>序号</span>
                </td>
                <td class="TD_STYLE1">
                    <span name="11">档案编号</span>
                </td>
                <td class="TD_STYLE1">
                    <span>姓名</span>
                </td>
                <td id="tkg" class="TD_STYLE1">薪酬基本明细</td>
                <td class="TD_STYLE1" hidden="hidden" id="tyi">
                    基本工资
                </td>

                <td class="TD_STYLE1" hidden="hidden" id="ter">
                    岗位工资
                </td>

                <td class="TD_STYLE1" hidden="hidden" id="tsan">
                    交通补贴
                </td>

                <td class="TD_STYLE1" hidden="hidden" id="tsi">
                    午餐补助
                </td>

                <td class="TD_STYLE1" hidden="hidden" id="twu">
                    五险一金
                </td>
                <td class="TD_STYLE1" width="7%">
                    奖励金额
                </td>
                <td class="TD_STYLE1" width="7%">
                    销售绩效总额
                </td>
                <td class="TD_STYLE1" width="7%">
                    应扣金额
                </td>
                <td class="TD_STYLE1" width="7%">
                    实发金额
                </td>
            </tr>


            @foreach (var item in list)
            {
                bosum = "bounsSum";
                saleSum = "saleSum";
                deductSum = "deductSum";
                salaryPaidSum = "salaryPaidSum";
                salaryStandardSum = "salaryStandardSum";
                yi = "yi"; er = "er"; san = "san"; si = "si"; wu = "wu"; kg = "kg";
                did = "did"; name = "name"; jl = "jl"; jx = "jx"; yk = "yk"; bz = "bz"; sf = "sf";
                salaryPaidSum2 = "salaryPaidSum2";
                jlid = "jlid"; jxid = "jxid"; ykid = "ykid"; sfid = "sfid";
                index++;
                bosum = bosum + index;
                saleSum = saleSum + index;
                deductSum = deductSum + index;
                salaryPaidSum = salaryPaidSum + index;
                salaryStandardSum = salaryStandardSum + index;
                yi = yi + index; er = er + index; san = san + index; si = si + index; wu = wu + index; kg = kg + index;
                did = "did" + index; name = "name" + index; jl = "jl" + index; jx = "jx" + index; yk = "yk" + index; bz = "bz" + index; sf = "sf" + index;
                jlid = "jlid" + index; jxid = "jxid" + index; ykid = "ykid" + index; sfid = "sfid" + index;
                salaryPaidSum2 = "salaryPaidSum2" + index;
                if (index == 1)
                {
                    <input type="hidden" name="grantDetails[0].salaryGrantId" value="HS1353753198460">
                    <input type="hidden" id="@salaryStandardSum" name="grantDetails[0].salaryStandardSum" value="@item.sf" />
                    <tr class="TD_STYLE2">
                        <td>
                            @index
                        </td>
                        <td>
                            @item.did
                            <input type="hidden" name="@did" value="@item.did" />
                        </td>
                        <td>
                            @item.name
                            <input type="hidden" name="@name" value="@item.name" />
                        </td>
                        <td hidden="hidden" id="@yi">
                            @item.jb

                        </td>
                        <td hidden="hidden" id="@er">
                            @item.gw
                        </td>
                        <td hidden="hidden" id="@san">
                            @item.jt
                        </td>
                        <td hidden="hidden" id="@si">
                            @item.wc
                        </td>
                        <td hidden="hidden" id="@wu">
                            @item.wx  &nbsp&nbsp&nbsp&nbsp&nbsp  <a id="xq" hidden="hidden" style="color:deepskyblue;cursor:pointer" onclick="xq()">收起详情信息</a>
                        </td>
                        <td id="kg" align="center" style="color:deepskyblue;cursor:pointer" onclick="kg('@index')">点击查看详情</td>
                        <td>
                            <input type="text" name="grantDetails[0].bounsSum" id="@bosum" onkeyup="onKeyPress('@index')" class="INPUT_STYLE2" />
                            <input type="text" name="@jl" hidden="hidden" id="@jlid" />
                        </td>
                        <td>
                            <input type="text" name="grantDetails[0].saleSum" id="@saleSum" onkeyup="onKeyPress('@index')" class="INPUT_STYLE2" />
                            <input type="text" name="@jx" hidden="hidden" id="@jxid" />
                        </td>
                        <td>
                            <input type="text" name="grantDetails[0].deductSum" id="@deductSum" onkeyup="onKeyPress('@index')" class="INPUT_STYLE2" />
                            <input type="text" name="@yk" hidden="hidden" id="@ykid" />
                        </td>
                        <td>
                            <input type="text" name="grantDetails[0].salaryPaidSum" readonly="readonly" id="@salaryPaidSum" value="@item.sf" class="INPUT_STYLE2" />
                            <input type="text" name="@salaryPaidSum" value="@sum" hidden="hidden" /><input type="text" id="@sfid" hidden="hidden" name="@salaryPaidSum2" value="" />
                        </td>

                    </tr>
                }
                else
                {
                    <input type="hidden" name="grantDetails[0].salaryGrantId" value="HS1353753198460">
                    <input type="hidden" id="@salaryStandardSum" name="grantDetails[0].salaryStandardSum" value="@item.sf" />
                    <tr class="TD_STYLE2">
                        <td>
                            @index
                        </td>
                        <td>
                            @item.did
                            <input type="hidden" name="@did" value="@item.did" />
                        </td>
                        <td>
                            @item.name
                            <input type="hidden" name="@name" value="@item.name" />
                        </td>
                        <td hidden="hidden" id="@yi">
                            @item.jb
                        </td>
                        <td hidden="hidden" id="@er">
                            @item.gw
                        </td>
                        <td hidden="hidden" id="@san">
                            @item.jt
                        </td>
                        <td hidden="hidden" id="@si">
                            @item.wc
                        </td>
                        <td hidden="hidden" id="@wu">
                            @item.wx
                        </td>

                        <td>
                            <input type="text" name="grantDetails[0].bounsSum" id="@bosum" onkeyup="onKeyPress('@index')" class="INPUT_STYLE2" />
                            <input type="text" name="@jl" id="@jlid" hidden="hidden" />
                        </td>
                        <td>
                            <input type="text" name="grantDetails[0].saleSum" id="@saleSum" onkeyup="onKeyPress('@index')" class="INPUT_STYLE2" />
                            <input type="text" name="@jx" id="@jxid" hidden="hidden" />
                        </td>
                        <td>
                            <input type="text" name="grantDetails[0].deductSum" id="@deductSum" onkeyup="onKeyPress('@index')" class="INPUT_STYLE2" />
                            <input type="text" name="@yk" id="@ykid" hidden="hidden" />
                        </td>
                        <td>
                            <input type="text" name="grantDetails[0].salaryPaidSum" readonly="readonly" id="@salaryPaidSum" value="@item.sf" class="INPUT_STYLE2" />
                            <input type="text" name="@salaryPaidSum" value="@sum" hidden="hidden" /><input type="text" name="@salaryPaidSum2" id="@sfid" value="" hidden="hidden" />
                        </td>

                    </tr>
                }

            }
            <tr>
                <td hidden><span id="cs">@index</span><input type="hidden" name="row" value="@index" /><input type="hidden" name="bid" value="@bid" /></td>

            </tr>
        </table>

        <script type="text/javascript">
            $("kg1").attr("rowspan", 4);
        </script>
    </form>
    <button class="btn btn-primary btn-lg" data-toggle="modal"
            data-target="#myModal">
        开始演示模态框
    </button><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog"
                                     aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        模态框（Modal）标题
                    </h4>
                </div>
                <div class="modal-body">
                    在这里添加一些文本
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default"
                            data-dismiss="modal">
                        关闭
                    </button>
                    <button type="button" class="btn btn-primary">
                        提交更改
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
    <SCRIPT type="text/javascript">
        function kg(index) {
            var cs = $("#cs").text();
            for (var i = 1; i <= cs; i++) {
                var yi = "#yi" + i;
                var er = "#er" + i;
                var san = "#san" + i;
                var si = "#si" + i;
                var wu = "#wu" + i;
                $("#xq").show();
                $("" + yi + "").show(); $("#tyi").show();
                $("" + er + "").show(); $("#ter").show();
                $("" + san + "").show(); $("#tsan").show();
                $("" + si + "").show(); $("#tsi").show();
                $("" + wu + "").show(); $("#twu").show();
                $("#tkg").hide(); $("#kg").hide();
            }

        }
        function xq() {
            var cs = $("#cs").text();
            for (var i = 1; i <= cs; i++) {
                var yi = "#yi" + i;
                var er = "#er" + i;
                var san = "#san" + i;
                var si = "#si" + i;
                var wu = "#wu" + i;
                $("#xq").hide();
                $("" + yi + "").hide(); $("#tyi").hide();
                $("" + er + "").hide(); $("#ter").hide();
                $("" + san + "").hide(); $("#tsan").hide();
                $("" + si + "").hide(); $("#tsi").hide();
                $("" + wu + "").hide(); $("#twu").hide();
                $("#tkg").show(); $("#kg").show();
            }

        }
        function onKeyPress(i) {

            var size = 5;
            var bounsSum = document.getElementById("bounsSum" + i);
            var saleSum = document.getElementById("saleSum" + i);
            var deductSum = document.getElementById("deductSum" + i);
            var salaryPaidSum = document.getElementById("salaryPaidSum" + i);
            var ji = document.getElementById("jlid" + i);
            var jx = document.getElementById("jxid" + i);
            var yk = document.getElementById("ykid" + i);
            var sf = document.getElementById("sfid" + i);
            //var jl = $("input[name='jl'+" + i + "]");
            //var jx = $("input[name='jx'+" + i + "]");
            //var yk = $("input[name='yk'+" + i + "]");
            if (isNaN(bounsSum.value) || bounsSum.value < 0) {
                alert("金额填写错误!");
                bounsSum.value = "0.00";
                return;
            }
            if (isNaN(saleSum.value) || saleSum.value < 0) {
                alert("金额填写错误!");
                saleSum.value = "0.00";
                return;
            }
            if (isNaN(deductSum.value) || deductSum.value < 0) {
                alert("金额填写错误!");
                deductSum.value = "0.00";
                return;
            }
            salaryPaidSum.value = Number(bounsSum.value) + Number(saleSum.value) - Number(deductSum.value) + Number(document.getElementById("salaryStandardSum" + i).value);
            sf.value = salaryPaidSum.value;

            ji.value = Number(bounsSum.value); /*jx.val(Number(saleSum.value)); yk.val(Number(deductSum.value));*/
            jx.value = Number(saleSum.value);
            yk.value = Number(deductSum.value);

            var sum = 0;
            var cs = $("#cs").text();
            for (var j = 1; j <= cs; j++) {
                sum = Number(sum) + Number(document.getElementById("salaryPaidSum" + j).value);
            }

            $("#salarySum_sum").text(sum); $("#sfs").val(sum);
        }



        function time() {
            var tdate = document.getElementById("Tdate");
            var d = new Date();
            var y = d.getFullYear();
            var moth = d.getMonth() + 1;
            var date = d.getDate();
            var h = d.getHours();
            var m = d.getMinutes();
            var s = d.getSeconds();
            var hh = 20 - 1 - h;
            var mm = 60 - 1 - m;
            var ss = 60 - s;
            if (hh > 0) {
                mm = mm + 60 * hh;
            }
            if (moth < 10) {
                moth = "0" + moth;
            }
            if (date < 10) {
                date = "0" + date;
            }
            if (h < 10) {
                h = "0" + h;
            }
            if (m < 10) {
                m = "0" + m;
            }
            if (s < 10) {
                s = "0" + s;
            }
            if (mm < 10) {
                mm = "0" + mm;
            }
            if (ss < 10) {
                ss = "0" + ss;
            }

            tdate.innerHTML = y + "-" + moth + "-" + date + " " + h + ":" + m + ":" + s;
            document.getElementById("Tdate2").value = tdate.innerHTML;
        }
        window.onload = time;
        var out = window.setInterval(time, 1000);
    </SCRIPT>
</body>
</html>
